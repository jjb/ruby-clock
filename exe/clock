#!/usr/bin/env ruby

require 'ruby-clock'

class Rufus::Scheduler::Job
  def identifier
    @identifier ||= begin
      name || handler.source.split("\n").reject(&:empty?).grep_v(/#.*/)[-2].strip
    rescue
      source_location.join('-')
    rescue
      'error-calculating-job-identifier'
    end
  end
end

include RubyClock

listen_to_signals

load 'Clockfile'

run_jobs
